<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bubble Cursor Working Example</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      background: #111;
      color: white;
      font-family: sans-serif;
    }
    canvas.bubble-cursor {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 9999;
    }
    h1 {
      padding: 20px;
      text-align: center;
    }
  </style>
</head>
<body>

<h1>Move your mouse and see the bubbles!</h1>

<script>
  class Particle {
    constructor(x, y) {
      this.life = Math.floor(Math.random() * 60 + 60);
      this.initialLife = this.life;
      this.velocity = {
        x: (Math.random() < 0.5 ? -1 : 1) * (Math.random() / 10),
        y: -0.4 + Math.random() * -1,
      };
      this.position = { x, y };
      this.size = 4;
    }

    update(ctx) {
      this.position.x += this.velocity.x;
      this.position.y += this.velocity.y;
      this.velocity.x += ((Math.random() < 0.5 ? -1 : 1) * 2) / 75;
      this.velocity.y -= Math.random() / 600;
      this.life--;

      const scale =
        0.2 + (this.initialLife - this.life) / this.initialLife;

      ctx.fillStyle = "#e6f1f7";
      ctx.strokeStyle = "#3a92c5";
      ctx.beginPath();
      ctx.arc(
        this.position.x - (this.size / 2) * scale,
        this.position.y - this.size / 2,
        this.size * scale,
        0,
        2 * Math.PI
      );
      ctx.stroke();
      ctx.fill();
      ctx.closePath();
    }
  }

  (function () {
    const canvas = document.createElement("canvas");
    canvas.className = "bubble-cursor";
    document.body.appendChild(canvas);

    const ctx = canvas.getContext("2d");
    let width = (canvas.width = window.innerWidth);
    let height = (canvas.height = window.innerHeight);

    const particles = [];

    function addParticle(x, y) {
      particles.push(new Particle(x, y));
    }

    function onMove(e) {
      addParticle(e.clientX, e.clientY);
    }

    function loop() {
      ctx.clearRect(0, 0, width, height);
      particles.forEach((p) => p.update(ctx));
      for (let i = particles.length - 1; i >= 0; i--) {
        if (particles[i].life < 0) particles.splice(i, 1);
      }
      requestAnimationFrame(loop);
    }

    window.addEventListener("mousemove", onMove);
    window.addEventListener("resize", () => {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    });

    loop();
  })();
</script>

</body>
</html>
